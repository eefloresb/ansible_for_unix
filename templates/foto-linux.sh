#!/bin/bash
export COLUMNS=192
LOGFILE=/tmp/$(hostname)_$(date '+%d%b%Y_%H%M%S').txt
for SERVER_PHOTO_SO in $(hostname -s)
do
echo "---------------------------------- START uptime ----------------------------------"
uptime
echo "---------------------------------- END uptime ----------------------------------"
echo ""

echo "---------------------------------- START who -b ----------------------------------"
who -b
echo "---------------------------------- END who -b ----------------------------------"
echo ""


echo "---------------------------------- START date ----------------------------------"
date
echo "---------------------------------- END date ----------------------------------"
echo ""

echo "---------------------------------- START /etc/modprobe.conf ----------------------------------"
cat /etc/modprobe.conf
echo
lsmod
echo
echo "---------------------------------- END /etc/modprobe.conf ----------------------------------"
echo ""

echo "---------------------------------- START cat /etc/redhat-release ----------------------------------"
cat /etc/redhat-release
echo "---------------------------------- END cat /etc/redhat-release ----------------------------------"
echo ""

echo "---------------------------------- START cat /etc/SuSE-release ----------------------------------"
cat /etc/SuSE-release
echo "---------------------------------- END cat /etc/SuSE-release ----------------------------------"
echo ""

echo "---------------------------------- START uname -a ----------------------------------"
uname -a
echo "---------------------------------- END uname -a ----------------------------------"
echo ""

echo "---------------------------------- START dmidecode ----------------------------------"
dmidecode --t 1
echo "---------------------------------- END dmidecode ----------------------------------"
echo ""

echo "---------------------------------- START lsblk ----------------------------------"
/bin/lsblk
echo "---------------------------------- END lsblk ----------------------------------"
echo ""

echo "---------------------------------- START lsblk ----------------------------------"
/usr/bin/lsblk
echo "---------------------------------- END lsblk ----------------------------------"
echo ""

echo "---------------------------------- START blkid ----------------------------------"
/usr/sbin/blkid
echo "---------------------------------- END blkid ----------------------------------"
echo ""

echo "---------------------------------- START blkid 2 ----------------------------------"
blkid
echo "---------------------------------- END blkid 2 ----------------------------------"
echo ""

echo "---------------------------------- START fdisk  ----------------------------------"
/usr/sbin/fdisk -l
echo "---------------------------------- END fdisk ----------------------------------"
echo ""

echo "---------------------------------- START /etc/passwd ----------------------------------"
cat /etc/passwd
echo "---------------------------------- END /etc/passwd ----------------------------------"
echo ""

echo "---------------------------------- START /etc/shadow ----------------------------------"
cat /etc/shadow
echo "---------------------------------- END /etc/shadow ----------------------------------"
echo ""

echo "---------------------------------- START /etc/group ----------------------------------"
cat /etc/group
echo "---------------------------------- END /etc/group ----------------------------------"
echo ""

echo "---------------------------------- START /etc/sudoers ----------------------------------"
cat /etc/sudoers | grep -v ^#
ls /etc/sudoers.d/* | while read file; do echo $file; echo; cat $file | grep -v ^#; echo; done
echo "---------------------------------- END /etc/sudoers ----------------------------------"
echo ""

echo "---------------------------------- START who -r ----------------------------------"
who -r
echo "---------------------------------- END who -r ----------------------------------"
echo ""

echo "---------------------------------- START cat /etc/hosts ----------------------------------"
egrep -v '(^#|^$)' /etc/hosts
echo "---------------------------------- END cat /etc/hosts ----------------------------------"
echo ""

echo "---------------------------------- START crontab -l ----------------------------------"
crontab -l
echo "---------------------------------- END crontab -l ----------------------------------"
echo ''

echo "---------------------------------- START crontab users ----------------------------------"
sed 's/^\([^:]*\):.*$/crontab -u \1 -l 2>\&1/' /etc/passwd | sh | grep -v "no crontab for"
echo "---------------------------------- END crontab users ----------------------------------"
echo ''

echo "---------------------------------- START /usr/sbin/showmount -e ----------------------------------"
/usr/sbin/showmount -e
echo "---------------------------------- END /usr/sbin/showmount -e ----------------------------------"
echo ""

echo "---------------------------------- START exports ----------------------------------"
cat /etc/exports
echo "---------------------------------- END exports ----------------------------------"
echo ""

echo "---------------------------------- START ps aux ----------------------------------"
ps aux
echo "---------------------------------- END ps aux ----------------------------------"
echo ""

echo "---------------------------------- START /etc/fstab ----------------------------------"
cat /etc/fstab
echo "---------------------------------- END /etc/fstab ----------------------------------"
echo ""

echo "---------------------------------- START mount ----------------------------------"
mount
echo "---------------------------------- END mount ----------------------------------"
echo ""

echo "---------------------------------- START pvs ----------------------------------"
pvs
echo "---------------------------------- END pvs ----------------------------------"
echo ""

echo "---------------------------------- START /usr/sbin/pvdisplay ----------------------------------"
pvdisplay
echo "---------------------------------- END /usr/sbin/pvdisplay ----------------------------------"
echo ""

echo "---------------------------------- START vgs ----------------------------------"
vgs
echo "---------------------------------- END vgs ----------------------------------"
echo ""

echo "---------------------------------- START /usr/sbin/vgdisplay ----------------------------------"
vgdisplay
echo "---------------------------------- END /usr/sbin/vgdisplay ----------------------------------"
echo ""

echo "---------------------------------- START lvs ----------------------------------"
lvs
echo "---------------------------------- END lvs ----------------------------------"
echo ""

echo "---------------------------------- START /usr/sbin/lvdisplay ----------------------------------"
lvdisplay
echo "---------------------------------- END /usr/sbin/lvdisplay ----------------------------------"
echo ""

echo "---------------------------------- START /sbin/ifconfig ----------------------------------"
/sbin/ifconfig 
echo
echo "---------------------------------- END /sbin/ifconfig ----------------------------------"
echo ""


echo "---------------------------------- START /sbin/ifconfig -a ----------------------------------"
/sbin/ifconfig -a 
echo
echo "---------------------------------- END /sbin/ifconfig -a ----------------------------------"
echo ""


echo "---------------------------------- START /sbin/ip a ----------------------------------"
ip a
echo
echo "---------------------------------- END /sbin/ip a ----------------------------------"
echo ""


echo "---------------------------------- START /sbin/ips ----------------------------------"
ls /etc/sysconfig/network-scripts/ifcfg-* | while read netw; do cat $netw; echo; done
echo
echo "---------------------------------- END /sbin/ips ----------------------------------"
echo ""


echo "---------------------------------- START /sbin/bonding ----------------------------------"
ls /proc/net/bonding/bond* | while read bond; do echo $bond; cat $bond; echo; done
echo "---------------------------------- END /sbin/bonding ----------------------------------"
echo ""


echo "---------------------------------- START SELINUX----------------------------------"
sestatus
echo "---------------------------------- END SELINUX ----------------------------------"
echo ""

echo "---------------------------------- START IPTABLES ----------------------------------"
iptables -L -nvx
echo
echo ""
iptables -t nat -L -nvx
echo "---------------------------------- END IPTABLES----------------------------------"
echo ""


echo "---------------------------------- START FIREWALLD----------------------------------"
systemctl status firewalld
echo
firewall-cmd --state
echo
echo "---------------------------------- END FIREWALLD----------------------------------"

echo "---------------------------------- START /sbin/route -n ----------------------------------"
/sbin/route -n
echo "---------------------------------- END /sbin/route -n ----------------------------------"
echo ""


echo "---------------------------------- START /sbin/route -n ----------------------------------"
ls /etc/sysconfig/network-scripts/route-* | while read net; do cat $net; echo; done
echo "---------------------------------- END /sbin/route -n ----------------------------------"
echo ""

echo "---------------------------------- START free ----------------------------------"
free
echo "---------------------------------- END free ----------------------------------"
echo ""

echo "---------------------------------- START cat /proc/swaps ----------------------------------"
cat /proc/swaps
echo "---------------------------------- END cat /proc/swaps ----------------------------------"
echo ""

echo "---------------------------------- START df -P ----------------------------------"
df -P
echo
df -hT
echo
echo "---------------------------------- END df -P ----------------------------------"
echo ""

echo "---------------------------------- START Permisos de filesystem ----------------------------------"
for FS in $(df -Plh | awk '{print $6}' | egrep -v '^(Mounted|/dev)'); do ls -ld $FS; done
echo "---------------------------------- END Permisos de filesystem ----------------------------------"
echo ""

echo "---------------------------------- START cat /etc/resolv.conf ----------------------------------"
cat /etc/resolv.conf
echo "---------------------------------- END cat /etc/resolv.conf ----------------------------------"
echo ""

echo "---------------------------------- START netstat -tupan | egrep (LISTEN|^udp) ----------------------------------"
netstat -tupan | egrep "(LISTEN|^udp)"
echo "---------------------------------- END netstat -tupan | egrep (LISTEN|^udp) ----------------------------------"
echo ""

echo "---------------------------------- START /sbin/chkconfig --list ----------------------------------"
/sbin/chkconfig --list
echo "---------------------------------- END /sbin/chkconfig --list ----------------------------------"
echo ""

echo "---------------------------------- START /usr/bin/systemctl  ----------------------------------"
/usr/bin/systemctl --type=service --state=running
echo "---------------------------------- END /usr/bin/systemctl ----------------------------------"
echo ""


echo "---------------------------------- START /sbin/lspci ----------------------------------"
/sbin/lspci
echo "---------------------------------- END /sbin/lspci ----------------------------------"
echo ""

echo "---------------------------------- START /sbin/lssci ----------------------------------"
/bin/lsscsi
/sbin/lssci
/usr/bin/lsscsi
echo "---------------------------------- END /sbin/lssci ----------------------------------"
echo ""


echo "---------------------------------- START ITM ----------------------------------"
/opt/IBM/ITM/bin/cinfo -r
echo "---------------------------------- END ITM ----------------------------------"
echo ""

echo "---------------------------------- START CUPS ----------------------------------"
cat /etc/cups/cupsd.conf
echo "---------------------------------- END CUPS ----------------------------------"
echo ""

echo "---------------------------------- START PRINTERS----------------------------------"
cat /etc/cups/printers.conf
echo "---------------------------------- END PRINTERS ----------------------------------"
echo ""

echo "---------------------------------- START SERVICES----------------------------------"
cat /etc/services
echo "---------------------------------- END SERVICES ----------------------------------"
echo ""

echo "---------------------------------- START /sbin/lspci -v ----------------------------------"
/sbin/lspci -v
echo "---------------------------------- END /sbin/lspci -v ----------------------------------"
echo ""


echo "---------------------------------- START /etc/profile -------------------------------"
cat /etc/profile
echo "---------------------------------- END /etc/profile ---------------------------------"
echo ""

echo "---------------------------------- START ENV-------------------------------"
env
echo "---------------------------------- END ENV---------------------------------"
echo ""

echo "---------------------------------- START MULTIPATH-------------------------------"
multipath -ll
echo "---------------------------------- END MULTIPATH---------------------------------"
echo ""

echo "---------------------------------- START MULTIPATH CONF-------------------------------"
cat /etc/multipath.conf
echo "---------------------------------- END MULTIPATH CONF---------------------------------"
echo ""

echo "---------------------------------- START UDEV -------------------------------"
ls -1 /etc/udev/rules.d/ | while read file; do echo $file; cat /etc/udev/rules.d/$file; echo; done
echo "---------------------------------- END UDEV---------------------------------"
echo ""

echo "---------------------------------- START mapper -------------------------------"
ls -l /dev/mapper/
echo "---------------------------------- END mapper---------------------------------"
echo ""

echo "---------------------------------- START dmsetup ls -------------------------------"
dmsetup ls
echo "---------------------------------- END dmsetup ls---------------------------------"
echo ""

echo "---------------------------------- START dmsetup info -------------------------------"
dmsetup info
echo "---------------------------------- END dmsetup info---------------------------------"
echo ""


echo "---------------------------------- START Informacion de dispositivos dev -------------------------------"
ls -lL /dev/*
echo "---------------------------------- END Informacion de dispositivos dev ---------------------------------"
echo ""

echo "---------------------------------- START Informacion de SAMBA -------------------------------"
cat /etc/samba/smb.conf
echo "---------------------------------- END Informacion de SAMBA ---------------------------------"
echo ""

echo "---------------------------------- START Informacion de Kerberos -------------------------------"
cat /etc/krb5.conf
echo "---------------------------------- END Informacion de Kerberos ---------------------------------"
echo ""

echo "---------------------------------- START Informacion de SSSD  -------------------------------"
cat /etc/sssd/sssd.conf
echo "---------------------------------- END Informacion de SSSD ---------------------------------"
echo ""

echo "---------------------------------- START Informacion de PAM  -------------------------------"
cat /etc/pam.d/password-auth
echo "----------------------------------------------------------------------------------------------"
cat /etc/pam.d/system-auth
echo "----------------------------------------------------------------------------------------------"
cat /etc/pam.d/common-account
echo "----------------------------------------------------------------------------------------------"
cat /etc/pam.d/common-auth
echo "----------------------------------------------------------------------------------------------"
cat /etc/pam.d/common-session
echo "---------------------------------- END Informacion de PAM  -------------------------------"
echo ""

done > ${LOGFILE} 2>&1
chmod 644 ${LOGFILE}
echo "Se genero el archivo ${LOGFILE}"
